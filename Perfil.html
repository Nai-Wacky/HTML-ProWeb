<!DOCTYPE html>
<html>
  <head>
    <meta
      charset="utf-8"
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />

    <link rel="stylesheet" href="StylePerfil.css" />

    <title>Mi perfil</title>

    <link rel="icon" href="images/Any-job-icon.ico" type="image/x-icon" />
  </head>

  <body style="background-color: #eeeeee">
    <div class="navbar">
      <!-- Logo Izquierda -->

      <button
        class="buttonImageLogo"
        onclick="window.location.assign('AnyJobHome.html')"
      >
        <img
          src="images/Any Job Imagotipo chiquito.png"
          width="180"
          height="60"
          title="Any job"
        />
      </button>

      <!-- Buscador -->

      <div style="margin: 0 auto" class="search-box">
        <input type="text" placeholder="Herramientas..." />
        <button onclick="window.location.assign('Perfil.html')">
          <img
            src="https://cdn-icons-png.flaticon.com/512/622/622669.png"
            alt="Buscar"
          />
        </button>
      </div>

      <!-- Opciones -->

      <button
        class="buttonOpcion"
        onclick="window.location.assign('Categorias.html')"
      >
        <img
          src="images/navbar/Pedidos.png"
          width="50"
          height="50"
          title="Catalogo de proveedores"
        />
      </button>

      <button
        class="buttonOpcion"
        onclick="window.location.assign('Carrito.html')"
      >
        <img
          src="images/navbar/Carrito de compras.png"
          width="35"
          height="35"
          title="Carrito de compras"
        />
      </button>
    </div>

    <!------------------------------------------------------------- Opciones ------------------------------------------------------------->

    <div id="modal" class="modal hidden">
      <div class="modal-content">
        <span class="close">&times;</span>
        <!--<h2>TÃ­tulo del modal</h2>-->
        <!--<p>Contenido...</p>-->
        <div class="confPerfil">
          <h3>Tu informaciÃ³n</h3>
          <form id="nombreForm">
            <div class="input-container">
              <input
                type="text"
                name="nombre"
                id="nombre"
                placeholder=" "
                required
              />
              <label for="nombre">Nombre de usuario</label>
            </div>
            <button type="submit">Guardar cambios</button>
          </form>
        </div>
      </div>
    </div>

    <div id="modalDatos" class="modal hidden">
      <div class="modal-content">
        <span class="close">&times;</span>
        <!--<h2>TÃ­tulo del modal</h2>-->
        <!--<p>Contenido...</p>-->
        <div class="confPerfil">
          <h3>Correo</h3>
          <form id="correoForm">
            <div class="input-container">
              <input
                type="text"
                name="correo"
                id="correo"
                placeholder=" "
                required
              />
              <label for="correo">Correo electronico</label>
            </div>
            <button type="submit">Guardar correo</button>
          </form>
          <h3 style="padding-top: 20px">Numero telefonico</h3>
          <form id="telefonoForm">
            <div class="input-container">
              <input
                type="text"
                name="telefono"
                id="telefono"
                placeholder=" "
                required
              />
              <label for="telefono">Numero telefonico</label>
            </div>
            <button type="submit">Guardar numero</button>
          </form>
        </div>
      </div>
    </div>

    <div id="modalSeguridad" class="modal hidden">
      <div class="modal-content">
        <span class="close">&times;</span>
        <!--<h2>TÃ­tulo del modal</h2>-->
        <!--<p>Contenido...</p>-->
        <div class="confPerfil">
          <h3>Cambiar contraseÃ±a</h3>
          <form id="passwordForm">
            <div class="input-container">
              <input
                type="text"
                name="password"
                id="password"
                placeholder=" "
                required
              />
              <label for="password">ContraseÃ±a</label>
            </div>
            <div class="input-container">
              <input
                type="text"
                name="verificar"
                id="verificar"
                placeholder=" "
                required
              />
              <label for="verificar">ContraseÃ±a</label>
            </div>
            <button type="submit">Cambiar contraseÃ±a</button>
          </form>
        </div>
      </div>
    </div>

    <div id="modalPedidos" class="modal hidden">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3>Tus pedidos</h3>
      </div>
    </div>

    <div class="supercontenedor">
      <div class="info-Perfil">
        <h3 id="tituloNombre">Nombre</h3>
        <p id="tituloCorreo">Correo</p>
      </div>
    </div>

    <div class="config-panel">
      <div class="config-item" data-target="modal">
        <div class="icon">ðŸ‘¤</div>
        <div class="content">
          <h3>Tu informaciÃ³n</h3>
          <p>Nombre elegido y datos para identificarte.</p>
        </div>
        <div class="arrow">â€º</div>
      </div>

      <div class="config-item" data-target="modalDatos">
        <div class="icon">âœ…</div>
        <div class="content">
          <h3>Datos de tu cuenta</h3>
          <p>
            Aqui puedes modificar datos de tu cuenta como correo y numero
            telefonico.
          </p>
        </div>
        <div class="arrow">â€º</div>
      </div>

      <div class="config-item" data-target="modalSeguridad">
        <div class="icon">ðŸ”’</div>
        <div class="content">
          <h3>Seguridad</h3>
          <p>Configura datos sensibles como tu contraseÃ±a.</p>
        </div>
        <div class="arrow">â€º</div>
      </div>

      <!--<div class="config-item" data-target="modalPedido">
        <div class="icon">ðŸ“¦</div>
        <div class="content">
          <h3>Pedidos</h3>
          <p>Visualiza los pedidos que has realizado.</p>
        </div>
        <div class="arrow">â€º</div>
      </div>

      <div class="config-item">
        <div class="icon">ðŸ’³</div>
        <div class="content">
          <h3>Tarjetas</h3>
          <p>Tarjetas guardadas en tu cuenta.</p>
        </div>
        <div class="arrow">â€º</div>
      </div>-->
    </div>

    <script>
      //----------------------------------------------MODAL NOMBRE----------------------------------------------
      // Mostrar modal al hacer clic
      document.querySelectorAll(".config-item").forEach((item) => {
        item.addEventListener("click", () => {
          const modalId = item.getAttribute("data-target") || "modal";
          document.getElementById(modalId).classList.remove("hidden");
        });
      });

      // Cerrar modal al hacer clic en la X
      document.querySelectorAll(".modal .close").forEach((btn) => {
        btn.addEventListener("click", () => {
          btn.closest(".modal").classList.add("hidden");
        });
      });

      // Cerrar modal si se hace clic fuera del contenido
      window.addEventListener("click", (e) => {
        const modals = document.querySelectorAll(".modal");
        modals.forEach((modal) => {
          if (e.target === modal) {
            modal.classList.add("hidden");
          }
        });
      });

      //----------------------------------------------MODAL DATOS----------------------------------------------
      // Mostrar modal al hacer clic
      document.querySelectorAll(".config-item").forEach((item) => {
        item.addEventListener("click", () => {
          const modalId = item.getAttribute("data-target") || "modalDatos";
          document.getElementById(modalId).classList.remove("hidden");
        });
      });

      // Cerrar modal al hacer clic en la X
      document.querySelectorAll(".modalDatos .close").forEach((btn) => {
        btn.addEventListener("click", () => {
          btn.closest(".modalDatos").classList.add("hidden");
        });
      });

      // Cerrar modal si se hace clic fuera del contenido
      window.addEventListener("click", (e) => {
        const modals = document.querySelectorAll(".modalDatos");
        modals.forEach((modal) => {
          if (e.target === modal) {
            modal.classList.add("hidden");
          }
        });
      });

      //----------------------------------------------MODAL SEGURIDAD----------------------------------------------
      // Mostrar modal al hacer clic
      document.querySelectorAll(".config-item").forEach((item) => {
        item.addEventListener("click", () => {
          const modalId = item.getAttribute("data-target") || "modalSeguridad";
          document.getElementById(modalId).classList.remove("hidden");
        });
      });

      // Cerrar modal al hacer clic en la X
      document.querySelectorAll(".modalSeguridad .close").forEach((btn) => {
        btn.addEventListener("click", () => {
          btn.closest(".modalSeguridad").classList.add("hidden");
        });
      });

      // Cerrar modal si se hace clic fuera del contenido
      window.addEventListener("click", (e) => {
        const modals = document.querySelectorAll(".modalSeguridad");
        modals.forEach((modal) => {
          if (e.target === modal) {
            modal.classList.add("hidden");
          }
        });
      });

      //----------------------------------------------LOCALSTORAGE----------------------------------------------

      const nombre = localStorage.getItem("nombre");
      const correo = localStorage.getItem("correo");
      const id_usuario = localStorage.getItem("id_usuario");
      const telefono = localStorage.getItem("telefono");

      if (nombre) {
        document.getElementById("nombre").value = nombre;
        document.getElementById("correo").value = correo;
        document.getElementById("telefono").value = telefono;
        document.getElementById("tituloNombre").textContent = nombre;
        document.getElementById("tituloCorreo").textContent = correo;
      } else {
        // Si no hay datos en localStorage, redirigir a login
        window.location.href = "Login.html";
      }

      //----------------------------------------------BASE DE DATOS----------------------------------------------

      const form = document.getElementById("nombreForm");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const correo = document.getElementById("corr").value;
        const password = document.getElementById("password").value;

        const response = await fetch("phps/endPointLogin.php", {
          method: "POST",
          headers: {
            "Content-Type": "application/x-www-form-urlencoded",
          },
          body: `corr=${encodeURIComponent(
            correo
          )}&password=${encodeURIComponent(password)}`,
        });

        const data = await response.json();

        if (data.error) {
          //ERROR
        } else {
          //SUCESS
        }
      });
    </script>
  </body>
</html>
